<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GenCyber - Security Testing on AmpliPi</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0d1117;
            color: #c9d1d9;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* Kali Linux Terminal Background */
        .kali-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(135deg, #0d1117 0%, #161b22 50%, #0d1117 100%),
                radial-gradient(circle at 20% 50%, rgba(33, 186, 69, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 50%, rgba(139, 148, 158, 0.05) 0%, transparent 50%);
            z-index: 1;
        }

        /* Matrix-style background */
        .matrix-rain {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            opacity: 0.05;
            z-index: 2;
        }

        .matrix-column {
            position: absolute;
            top: -100%;
            font-family: monospace;
            font-size: 16px;
            color: #21ba45;
            animation: matrixFall linear infinite;
        }

        @keyframes matrixFall {
            to {
                transform: translateY(calc(100vh + 100%));
            }
        }

        /* Content Wrapper */
        .content-wrapper {
            position: relative;
            z-index: 10;
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 40px;
            animation: fadeInDown 1s ease-out;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .kali-badge {
            display: inline-block;
            background: linear-gradient(135deg, #21ba45, #1a8b33);
            padding: 10px 30px;
            border-radius: 30px;
            font-size: 0.9em;
            font-weight: 600;
            letter-spacing: 1px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(33, 186, 69, 0.3);
        }

        .main-title {
            font-size: clamp(2.5em, 5vw, 4em);
            font-weight: 800;
            margin-bottom: 20px;
            background: linear-gradient(45deg, #21ba45, #58a6ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            color: #8b949e;
            font-size: 1.3em;
            font-weight: 300;
        }

        /* Attack Dashboard */
        .attack-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .attack-card {
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .attack-card:hover {
            border-color: #21ba45;
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(33, 186, 69, 0.2);
        }

        .attack-card.active {
            border-color: #21ba45;
            background: #1c2128;
            box-shadow: 0 0 30px rgba(33, 186, 69, 0.3);
        }

        .attack-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
            display: inline-block;
        }

        .attack-title {
            color: #58a6ff;
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .attack-desc {
            color: #8b949e;
            font-size: 0.95em;
            line-height: 1.5;
        }

        .attack-status {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #6e7681;
        }

        .attack-status.ready {
            background: #ffa502;
            animation: pulse 2s infinite;
        }

        .attack-status.active {
            background: #21ba45;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; box-shadow: 0 0 0 0 currentColor; }
            50% { opacity: 0.8; box-shadow: 0 0 0 8px transparent; }
        }

        /* Terminal Container */
        .terminal-container {
            background: #0d1117;
            border: 2px solid #30363d;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .terminal-header {
            background: #161b22;
            padding: 10px 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            border-bottom: 1px solid #30363d;
        }

        .terminal-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .dot-red { background: #f85149; }
        .dot-yellow { background: #ffa502; }
        .dot-green { background: #21ba45; }

        .terminal-title {
            flex: 1;
            text-align: center;
            font-family: monospace;
            color: #8b949e;
            font-size: 0.9em;
        }

        .terminal {
            background: #0d1117;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            color: #c9d1d9;
            height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
        }

        .terminal-line {
            margin: 5px 0;
            animation: typeLine 0.1s ease-out;
        }

        @keyframes typeLine {
            from { opacity: 0; transform: translateX(-10px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .terminal-prompt {
            color: #21ba45;
            font-weight: bold;
        }

        .terminal-command {
            color: #58a6ff;
        }

        .terminal-output {
            color: #8b949e;
        }

        .terminal-success {
            color: #21ba45;
            font-weight: bold;
        }

        .terminal-error {
            color: #f85149;
        }

        .terminal-warning {
            color: #ffa502;
        }

        /* Network Visualization */
        .network-viz-container {
            background: #161b22;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            position: relative;
            min-height: 400px;
        }

        .network-device {
            position: absolute;
            width: 100px;
            height: 100px;
            background: #0d1117;
            border: 2px solid #30363d;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10;
        }

        .network-device:hover {
            transform: scale(1.1);
            border-color: #58a6ff;
            box-shadow: 0 5px 20px rgba(88, 166, 255, 0.3);
        }

        .network-device.attacker {
            border-color: #f85149;
        }

        .network-device.target {
            border-color: #21ba45;
        }

        .device-icon {
            font-size: 2.5em;
            margin-bottom: 5px;
        }

        .device-label {
            font-size: 0.9em;
            font-weight: 600;
        }

        .device-ip {
            font-size: 0.8em;
            color: #8b949e;
            font-family: monospace;
        }

        /* Connection Lines */
        .connection-line {
            position: absolute;
            height: 2px;
            background: #30363d;
            transform-origin: left center;
            z-index: 5;
        }

        .connection-line.active {
            background: #21ba45;
            animation: dataFlow 2s linear infinite;
        }

        @keyframes dataFlow {
            0% { background: linear-gradient(90deg, transparent, #21ba45, transparent); }
            100% { background: linear-gradient(90deg, transparent, #21ba45, transparent); }
        }

        /* Data Packets */
        .data-packet {
            position: absolute;
            width: 20px;
            height: 20px;
            background: #21ba45;
            border-radius: 50%;
            box-shadow: 0 0 10px currentColor;
            pointer-events: none;
            z-index: 15;
        }

        .data-packet.attack {
            background: #f85149;
        }

        /* Attack Details Panel */
        .attack-details {
            background: #161b22;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            display: none;
        }

        .attack-details.active {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .details-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .details-title {
            font-size: 1.5em;
            color: #58a6ff;
            font-weight: 600;
        }

        .close-button {
            background: none;
            border: 1px solid #30363d;
            color: #8b949e;
            padding: 5px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close-button:hover {
            border-color: #f85149;
            color: #f85149;
        }

        /* Code Block */
        .code-block {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
        }

        .code-comment {
            color: #6e7681;
        }

        .code-keyword {
            color: #ff7b72;
        }

        .code-string {
            color: #a5d6ff;
        }

        .code-variable {
            color: #79c0ff;
        }

        /* Control Panel */
        .control-panel {
            background: #161b22;
            border-radius: 15px;
            padding: 20px;
            display: flex;
            gap: 15px;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }

        .control-button {
            background: #21863a;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .control-button:hover {
            background: #2ea043;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(33, 186, 69, 0.3);
        }

        .control-button.danger {
            background: #da3633;
        }

        .control-button.danger:hover {
            background: #f85149;
        }

        .control-button:disabled {
            background: #30363d;
            color: #6e7681;
            cursor: not-allowed;
            transform: none;
        }

        /* Results Panel */
        .results-panel {
            background: #0d1117;
            border: 2px solid #30363d;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .result-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 10px;
            border-bottom: 1px solid #30363d;
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .result-icon {
            font-size: 1.5em;
        }

        .result-text {
            flex: 1;
        }

        .result-value {
            font-family: monospace;
            color: #21ba45;
            font-weight: bold;
        }

        /* AmpliPi Device Image */
        .amplipro-showcase {
            text-align: center;
            margin: 30px 0;
            position: relative;
        }

        .amplipro-image {
            max-width: 100%;
            width: 800px;
            height: auto;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 2px solid #30363d;
        }

        .image-caption {
            margin-top: 15px;
            color: #8b949e;
            font-style: italic;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .attack-dashboard {
                grid-template-columns: 1fr;
            }
            
            .control-panel {
                flex-direction: column;
                gap: 10px;
            }
            
            .control-button {
                width: 100%;
                justify-content: center;
            }
            
            .network-viz-container {
                min-height: 500px;
            }
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #30363d;
            border-radius: 50%;
            border-top-color: #21ba45;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Wireshark View */
        .wireshark-view {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 15px;
            font-family: monospace;
            font-size: 0.85em;
            overflow-x: auto;
            margin: 20px 0;
        }

        .packet-line {
            display: flex;
            gap: 15px;
            padding: 5px 0;
            border-bottom: 1px solid #30363d;
        }

        .packet-line:hover {
            background: #161b22;
        }

        .packet-no {
            color: #8b949e;
            width: 50px;
        }

        .packet-time {
            color: #8b949e;
            width: 80px;
        }

        .packet-src {
            color: #58a6ff;
            width: 120px;
        }

        .packet-dst {
            color: #21ba45;
            width: 120px;
        }

        .packet-protocol {
            color: #ffa502;
            width: 60px;
        }

        .packet-info {
            color: #c9d1d9;
            flex: 1;
        }

        /* Success/Fail Indicators */
        .status-indicator {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 5em;
            opacity: 0;
            pointer-events: none;
            z-index: 100;
        }

        .status-indicator.success {
            color: #21ba45;
            animation: statusPop 1s ease-out;
        }

        .status-indicator.fail {
            color: #f85149;
            animation: statusPop 1s ease-out;
        }

        @keyframes statusPop {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0);
            }
            50% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.2);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        /* NEW: Attack Explanation Modal */
        .attack-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            overflow-y: auto;
            padding: 20px;
        }

        .attack-modal.active {
            display: flex;
        }

        .modal-content {
            background: #161b22;
            border: 2px solid #30363d;
            border-radius: 20px;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            background: #0d1117;
            padding: 20px 30px;
            border-bottom: 1px solid #30363d;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .modal-title {
            font-size: 1.8em;
            color: #58a6ff;
            font-weight: 700;
        }

        .modal-close {
            background: none;
            border: none;
            color: #8b949e;
            font-size: 1.5em;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .modal-close:hover {
            color: #f85149;
        }

        .modal-body {
            padding: 30px;
        }

        /* NEW: Visual Flow Diagrams */
        .flow-diagram {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            position: relative;
            min-height: 300px;
        }

        .flow-step {
            background: #161b22;
            border: 2px solid #30363d;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            position: relative;
            transition: all 0.3s ease;
        }

        .flow-step.active {
            border-color: #21ba45;
            box-shadow: 0 0 20px rgba(33, 186, 69, 0.3);
        }

        .flow-step-number {
            position: absolute;
            top: -15px;
            left: 20px;
            background: #21ba45;
            color: #0d1117;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .flow-arrow {
            text-align: center;
            color: #58a6ff;
            font-size: 1.5em;
            margin: 10px 0;
        }

        /* NEW: HTTP Headers Visualization */
        .http-headers-viz {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            font-family: monospace;
        }

        .http-header-line {
            padding: 8px;
            margin: 5px 0;
            border-radius: 5px;
            transition: all 0.3s ease;
        }

        .http-header-line.sent {
            background: rgba(33, 186, 69, 0.1);
            border-left: 3px solid #21ba45;
            animation: headerSend 0.5s ease-out;
        }

        @keyframes headerSend {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .http-header-line.pending {
            background: rgba(255, 165, 2, 0.1);
            border-left: 3px solid #ffa502;
            opacity: 0.6;
        }

        .http-header-line.missing {
            background: rgba(248, 81, 73, 0.1);
            border-left: 3px solid #f85149;
            border-style: dashed;
        }

        /* NEW: Password Attack Visualization */
        .password-viz {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }

        .password-attempt {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            font-family: monospace;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .password-attempt.trying {
            background: rgba(255, 165, 2, 0.1);
            border-color: #ffa502;
            animation: tryPassword 0.5s ease-out;
        }

        .password-attempt.failed {
            background: rgba(248, 81, 73, 0.1);
            border-color: #f85149;
            text-decoration: line-through;
            opacity: 0.5;
        }

        .password-attempt.success {
            background: rgba(33, 186, 69, 0.2);
            border-color: #21ba45;
            box-shadow: 0 0 20px rgba(33, 186, 69, 0.5);
            font-weight: bold;
        }

        @keyframes tryPassword {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* NEW: ARP Table Visualization */
        .arp-table {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .arp-table-header {
            display: grid;
            grid-template-columns: 1fr 2fr 2fr;
            gap: 15px;
            padding: 10px;
            background: #161b22;
            border-radius: 5px;
            font-weight: bold;
            color: #58a6ff;
        }

        .arp-entry {
            display: grid;
            grid-template-columns: 1fr 2fr 2fr;
            gap: 15px;
            padding: 10px;
            margin: 5px 0;
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 5px;
            transition: all 0.3s ease;
        }

        .arp-entry.poisoned {
            background: rgba(248, 81, 73, 0.1);
            border-color: #f85149;
            animation: arpPoison 1s ease-out;
        }

        @keyframes arpPoison {
            0% { background: #0d1117; }
            50% { background: rgba(248, 81, 73, 0.3); }
            100% { background: rgba(248, 81, 73, 0.1); }
        }

        /* NEW: Connection Pool Visualization */
        .connection-pool {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 10px;
            margin: 20px 0;
            padding: 20px;
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 10px;
        }

        .connection-slot {
            width: 40px;
            height: 40px;
            background: #161b22;
            border: 2px solid #30363d;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8em;
            transition: all 0.3s ease;
        }

        .connection-slot.occupied {
            background: rgba(248, 81, 73, 0.2);
            border-color: #f85149;
        }

        .connection-slot.available {
            background: rgba(33, 186, 69, 0.2);
            border-color: #21ba45;
        }

        /* NEW: Info Cards */
        .info-card {
            background: #161b22;
            border-left: 4px solid #58a6ff;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .info-card-title {
            color: #58a6ff;
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .info-card-content {
            color: #c9d1d9;
            line-height: 1.6;
        }

        /* NEW: Interactive Demo Buttons */
        .demo-controls {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .demo-button {
            background: #21863a;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .demo-button:hover {
            background: #2ea043;
            transform: translateY(-2px);
        }

        .demo-button.secondary {
            background: #30363d;
        }

        .demo-button.secondary:hover {
            background: #484f58;
        }

        /* NEW: Live Stats Display */
        .live-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #21ba45;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #8b949e;
            font-size: 0.9em;
        }

        /* NEW: Timeline Visualization */
        .attack-timeline {
            position: relative;
            padding: 20px 0;
            margin: 20px 0;
        }

        .timeline-line {
            position: absolute;
            left: 30px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #30363d;
        }

        .timeline-event {
            position: relative;
            padding-left: 60px;
            margin: 20px 0;
        }

        .timeline-dot {
            position: absolute;
            left: 20px;
            top: 5px;
            width: 20px;
            height: 20px;
            background: #21ba45;
            border-radius: 50%;
            border: 3px solid #0d1117;
        }

        .timeline-content {
            background: #161b22;
            border-radius: 10px;
            padding: 15px;
            border: 1px solid #30363d;
        }

        .timeline-time {
            color: #8b949e;
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .timeline-title {
            color: #58a6ff;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .timeline-desc {
            color: #c9d1d9;
            font-size: 0.95em;
        }
    </style>
</head>
<body>
    <!-- Kali Background -->
    <div class="kali-bg"></div>
    
    <!-- Matrix Rain Effect -->
    <div class="matrix-rain" id="matrixRain"></div>

    <!-- Main Content -->
    <div class="content-wrapper">
        <!-- Header -->
        <header class="header">
            <div class="kali-badge">🐉 KALI LINUX TESTING</div>
            <h1 class="main-title">Security Experiments on AmpliPi</h1>
            <p class="subtitle">Real-World Vulnerability Testing & Analysis</p>
        </header>

        <!-- Attack Selection Dashboard -->
        <div class="attack-dashboard">
            <!-- Hydra Attack Card -->
            <div class="attack-card" onclick="selectAttack('hydra')" id="hydraCard">
                <div class="attack-status ready"></div>
                <div class="attack-icon">🔑</div>
                <h3 class="attack-title">Dictionary Password Attack</h3>
                <p class="attack-desc">Using Hydra to crack weak passwords with rockyou.txt wordlist</p>
                <button class="demo-button secondary" style="margin-top: 15px; width: 100%;" onclick="event.stopPropagation(); showAttackExplanation('hydra')">
                    📖 Learn How It Works
                </button>
            </div>

            <!-- ARP Poisoning Card -->
            <div class="attack-card" onclick="selectAttack('arp')" id="arpCard">
                <div class="attack-status ready"></div>
                <div class="attack-icon">🎭</div>
                <h3 class="attack-title">ARP Cache Poisoning</h3>
                <p class="attack-desc">Man-in-the-Middle attack using Ettercap & Wireshark</p>
                <button class="demo-button secondary" style="margin-top: 15px; width: 100%;" onclick="event.stopPropagation(); showAttackExplanation('arp')">
                    📖 Learn How It Works
                </button>
            </div>

            <!-- Slowloris Card -->
            <div class="attack-card" onclick="selectAttack('slowloris')" id="slowlorisCard">
                <div class="attack-status ready"></div>
                <div class="attack-icon">🌊</div>
                <h3 class="attack-title">Slowloris DoS Attack</h3>
                <p class="attack-desc">Denial-of-Service attack exhausting web server resources</p>
                <button class="demo-button secondary" style="margin-top: 15px; width: 100%;" onclick="event.stopPropagation(); showAttackExplanation('slowloris')">
                    📖 Learn How It Works
                </button>
            </div>
        </div>

        <!-- Network Visualization -->
        <div class="network-viz-container" id="networkViz">
            <!-- Router -->
            <div class="network-device" style="left: 50%; top: 20%; transform: translateX(-50%);">
                <div class="device-icon">📡</div>
                <div class="device-label">Router</div>
                <div class="device-ip">192.168.1.1</div>
            </div>

            <!-- AmpliPi -->
            <div class="network-device target" style="left: 20%; top: 60%;" id="amplipiDevice">
                <div class="device-icon">🎵</div>
                <div class="device-label">AmpliPi</div>
                <div class="device-ip">192.168.1.101</div>
            </div>

            <!-- iPhone -->
            <div class="network-device" style="right: 20%; top: 60%;" id="iphoneDevice">
                <div class="device-icon">📱</div>
                <div class="device-label">iPhone</div>
                <div class="device-ip">192.168.1.105</div>
            </div>

            <!-- Kali Linux -->
            <div class="network-device attacker" style="left: 50%; bottom: 20%; transform: translateX(-50%);" id="kaliDevice">
                <div class="device-icon">🐉</div>
                <div class="device-label">Kali Linux</div>
                <div class="device-ip">192.168.1.110</div>
            </div>
        </div>

        <!-- Terminal Container -->
        <div class="terminal-container">
            <div class="terminal-header">
                <div class="terminal-dot dot-red"></div>
                <div class="terminal-dot dot-yellow"></div>
                <div class="terminal-dot dot-green"></div>
                <div class="terminal-title">root@kali:~# AmpliPi Security Testing</div>
            </div>
            <div class="terminal" id="mainTerminal">
                <div class="terminal-line"><span class="terminal-prompt">root@kali:~#</span> <span class="terminal-command">Ready for security testing...</span></div>
            </div>
        </div>

        <!-- Control Panel -->
        <div class="control-panel">
            <button class="control-button" onclick="runSelectedAttack()" id="runButton">
                ▶️ Run Attack
            </button>
            <button class="control-button danger" onclick="stopAttack()" id="stopButton" disabled>
                ⏹️ Stop Attack
            </button>
            <button class="control-button" onclick="clearTerminal()">
                🗑️ Clear Terminal
            </button>
            <button class="control-button" onclick="showNetworkScan()">
                🔍 Network Scan
            </button>
        </div>

        <!-- Attack Details Panels -->
        <!-- Hydra Details -->
        <div class="attack-details" id="hydraDetails">
            <div class="details-header">
                <h2 class="details-title">🔑 Dictionary Password Attack Details</h2>
                <button class="close-button" onclick="closeDetails()">✕</button>
            </div>
            
            <div class="code-block">
                <span class="code-comment"># Hydra command for AmpliPi password attack</span><br>
                <span class="code-keyword">hydra</span> <span class="code-variable">-l admin -P /usr/share/wordlists/rockyou.txt</span> <span class="code-string">192.168.1.101</span> <span class="code-keyword">http-post-form</span> \<br>
                <span class="code-string">"/auth/login?next_url=/:username=admin&password=^PASS^:R=302"</span>
            </div>

            <div class="results-panel">
                <h3 style="color: #58a6ff; margin-bottom: 15px;">Discovered Vulnerabilities:</h3>
                <div class="result-item">
                    <div class="result-icon">❌</div>
                    <div class="result-text">No HTTPS encryption</div>
                </div>
                <div class="result-item">
                    <div class="result-icon">❌</div>
                    <div class="result-text">No password complexity requirements</div>
                </div>
                <div class="result-item">
                    <div class="result-icon">❌</div>
                    <div class="result-text">No account lockout mechanism</div>
                </div>
                <div class="result-item">
                    <div class="result-icon">✅</div>
                    <div class="result-text">Password found: <span class="result-value">abc123</span></div>
                </div>
            </div>
        </div>

        <!-- ARP Poisoning Details -->
        <div class="attack-details" id="arpDetails">
            <div class="details-header">
                <h2 class="details-title">🎭 ARP Cache Poisoning Details</h2>
                <button class="close-button" onclick="closeDetails()">✕</button>
            </div>
            
            <div class="code-block">
                <span class="code-comment"># Ettercap command for MITM attack</span><br>
                <span class="code-keyword">ettercap</span> <span class="code-variable">-T -M arp:remote</span> <span class="code-string">/192.168.1.101//</span> <span class="code-string">/192.168.1.105//</span>
            </div>

            <div class="wireshark-view" id="wiresharkView">
                <div class="packet-line">
                    <span class="packet-no">1</span>
                    <span class="packet-time">0.000000</span>
                    <span class="packet-src">192.168.1.105</span>
                    <span class="packet-dst">192.168.1.101</span>
                    <span class="packet-protocol">ARP</span>
                    <span class="packet-info">Who has 192.168.1.101? Tell 192.168.1.105</span>
                </div>
                <div class="packet-line">
                    <span class="packet-no">2</span>
                    <span class="packet-time">0.000142</span>
                    <span class="packet-src">192.168.1.110</span>
                    <span class="packet-dst">192.168.1.105</span>
                    <span class="packet-protocol">ARP</span>
                    <span class="packet-info">192.168.1.101 is at 00:11:22:33:44:55 (Spoofed)</span>
                </div>
                <div class="packet-line">
                    <span class="packet-no">3</span>
                    <span class="packet-time">0.001523</span>
                    <span class="packet-src">192.168.1.105</span>
                    <span class="packet-dst">192.168.1.101</span>
                    <span class="packet-protocol">HTTP</span>
                    <span class="packet-info">POST /api/streams/play (Intercepted)</span>
                </div>
                <div class="packet-line">
                    <span class="packet-no">4</span>
                    <span class="packet-time">0.002147</span>
                    <span class="packet-src">192.168.1.105</span>
                    <span class="packet-dst">192.168.1.101</span>
                    <span class="packet-protocol">AirPlay</span>
                    <span class="packet-info">Metadata: Artist - "The Beatles", Track - "Hey Jude"</span>
                </div>
            </div>
        </div>

        <!-- Slowloris Details -->
        <div class="attack-details" id="slowlorisDetails">
            <div class="details-header">
                <h2 class="details-title">🌊 Slowloris DoS Attack Details</h2>
                <button class="close-button" onclick="closeDetails()">✕</button>
            </div>
            
            <div class="code-block">
                <span class="code-comment"># Slowloris command targeting AmpliPi web server</span><br>
                <span class="code-keyword">python3</span> <span class="code-variable">slowloris.py</span> <span class="code-variable">-p 80 -s 10000</span> <span class="code-string">192.168.1.101</span>
            </div>

            <div class="results-panel">
                <h3 style="color: #58a6ff; margin-bottom: 15px;">Attack Impact:</h3>
                <div class="result-item">
                    <div class="result-icon">🔴</div>
                    <div class="result-text">Web interface: <span class="result-value">Unresponsive</span></div>
                </div>
                <div class="result-item">
                    <div class="result-icon">🟢</div>
                    <div class="result-text">AirPlay streaming: <span class="result-value">Still working</span></div>
                </div>
                <div class="result-item">
                    <div class="result-icon">📊</div>
                    <div class="result-text">Open connections: <span class="result-value">10,000+</span></div>
                </div>
            </div>
        </div>

        <!-- AmpliPi Device Showcase -->
        <div class="amplipro-showcase">
            <h2 style="color: #58a6ff; margin-bottom: 20px;">AmpliPi System Under Test</h2>
            <img src="data:image/svg+xml,%3Csvg width='800' height='400' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='800' height='400' fill='%231c2128' rx='15'/%3E%3Crect x='50' y='50' width='700' height='300' fill='%232a2a3e' rx='10'/%3E%3Ctext x='400' y='120' font-family='Arial' font-size='32' fill='%2358a6ff' text-anchor='middle'%3EAmpliPi Pro Audio System%3C/text%3E%3Cg%3E%3Crect x='100' y='160' width='150' height='150' fill='%23161b22' rx='8'/%3E%3Ctext x='175' y='240' font-family='Arial' font-size='48' fill='%2321ba45' text-anchor='middle'%3E🎵%3C/text%3E%3C/g%3E%3Cg%3E%3Crect x='300' y='160' width='150' height='150' fill='%23161b22' rx='8'/%3E%3Ctext x='375' y='240' font-family='Arial' font-size='48' fill='%2358a6ff' text-anchor='middle'%3E📡%3C/text%3E%3C/g%3E%3Cg%3E%3Crect x='500' y='160' width='150' height='150' fill='%23161b22' rx='8'/%3E%3Ctext x='575' y='240' font-family='Arial' font-size='48' fill='%23f85149' text-anchor='middle'%3E🔓%3C/text%3E%3C/g%3E%3Ctext x='175' y='290' font-family='Arial' font-size='14' fill='%238b949e' text-anchor='middle'%3E6 Zones%3C/text%3E%3Ctext x='375' y='290' font-family='Arial' font-size='14' fill='%238b949e' text-anchor='middle'%3ERaspberry Pi%3C/text%3E%3Ctext x='575' y='290' font-family='Arial' font-size='14' fill='%238b949e' text-anchor='middle'%3EPort 80 HTTP%3C/text%3E%3C/svg%3E" 
                 alt="AmpliPi System" class="amplipro-image">
            <p class="image-caption">Target: AmpliPro Home Audio System - IP: 192.168.1.101</p>
        </div>
    </div>

    <!-- Status Indicators -->
    <div class="status-indicator" id="statusIndicator"></div>

    <!-- Attack Explanation Modals -->
    <!-- Hydra Modal -->
    <div class="attack-modal" id="hydraModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">🔑 How Dictionary Password Attack Works</h2>
                <button class="modal-close" onclick="closeModal('hydraModal')">✕</button>
            </div>
            <div class="modal-body">
                <div class="info-card">
                    <div class="info-card-title">What is a Dictionary Attack?</div>
                    <div class="info-card-content">
                        A dictionary attack tries common passwords from a pre-compiled list (wordlist) against a target system. 
                        Hydra is a tool that automates this process, trying thousands of passwords per minute.
                    </div>
                </div>

                <div class="flow-diagram">
                    <h3 style="color: #58a6ff; margin-bottom: 20px;">Attack Process Flow</h3>
                    
                    <div class="flow-step" id="hydraStep1">
                        <div class="flow-step-number">1</div>
                        <strong>Load Wordlist</strong><br>
                        Hydra loads rockyou.txt containing 14+ million common passwords
                    </div>
                    
                    <div class="flow-arrow">⬇️</div>
                    
                    <div class="flow-step" id="hydraStep2">
                        <div class="flow-step-number">2</div>
                        <strong>Send Login Request</strong><br>
                        POST /auth/login with username=admin & password=[from wordlist]
                    </div>
                    
                    <div class="flow-arrow">⬇️</div>
                    
                    <div class="flow-step" id="hydraStep3">
                        <div class="flow-step-number">3</div>
                        <strong>Check Response</strong><br>
                        If response is 302 redirect → password is correct!<br>
                        If response is 401/403 → try next password
                    </div>
                </div>

                <h3 style="color: #58a6ff; margin: 20px 0;">Live Password Attempts Visualization</h3>
                <div class="password-viz" id="passwordViz">
                    <!-- Passwords will be added dynamically -->
                </div>

                <div class="demo-controls">
                    <button class="demo-button" onclick="simulatePasswordAttack()">▶️ Simulate Attack</button>
                    <button class="demo-button secondary" onclick="resetPasswordViz()">🔄 Reset</button>
                </div>

                <div class="live-stats">
                    <div class="stat-card">
                        <div class="stat-value" id="passAttempts">0</div>
                        <div class="stat-label">Passwords Tried</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="passSpeed">0</div>
                        <div class="stat-label">Attempts/Second</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="passTime">0s</div>
                        <div class="stat-label">Time Elapsed</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ARP Modal -->
    <div class="attack-modal" id="arpModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">🎭 How ARP Cache Poisoning Works</h2>
                <button class="modal-close" onclick="closeModal('arpModal')">✕</button>
            </div>
            <div class="modal-body">
                <div class="info-card">
                    <div class="info-card-title">What is ARP Poisoning?</div>
                    <div class="info-card-content">
                        ARP (Address Resolution Protocol) maps IP addresses to MAC addresses. 
                        In ARP poisoning, the attacker sends fake ARP messages to associate their MAC address 
                        with another device's IP, intercepting all traffic meant for that device.
                    </div>
                </div>

                <div class="flow-diagram">
                    <h3 style="color: #58a6ff; margin-bottom: 20px;">Normal vs Poisoned ARP Flow</h3>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h4 style="color: #21ba45; margin-bottom: 10px;">✅ Normal Communication</h4>
                            <div class="flow-step">
                                iPhone → Router → AmpliPi<br>
                                <small style="color: #8b949e;">Direct, secure path</small>
                            </div>
                        </div>
                        <div>
                            <h4 style="color: #f85149; margin-bottom: 10px;">❌ Poisoned Communication</h4>
                            <div class="flow-step">
                                iPhone → <span style="color: #f85149;">Kali Linux</span> → AmpliPi<br>
                                <small style="color: #8b949e;">Intercepted by attacker</small>
                            </div>
                        </div>
                    </div>
                </div>

                <h3 style="color: #58a6ff; margin: 20px 0;">ARP Table Visualization</h3>
                <div class="arp-table">
                    <div class="arp-table-header">
                        <div>Device</div>
                        <div>IP Address</div>
                        <div>MAC Address</div>
                    </div>
                    <div class="arp-entry" id="arpEntry1">
                        <div>🎵 AmpliPi</div>
                        <div>192.168.1.101</div>
                        <div id="arpMac1">AA:BB:CC:DD:EE:FF</div>
                    </div>
                    <div class="arp-entry" id="arpEntry2">
                        <div>📱 iPhone</div>
                        <div>192.168.1.105</div>
                        <div id="arpMac2">11:22:33:44:55:66</div>
                    </div>
                </div>

                <div class="demo-controls">
                    <button class="demo-button" onclick="simulateArpPoison()">🎭 Poison ARP Cache</button>
                    <button class="demo-button secondary" onclick="resetArpTable()">🔄 Reset</button>
                </div>

                <div class="info-card" style="margin-top: 20px;">
                    <div class="info-card-title">⚠️ What Can Attackers See?</div>
                    <div class="info-card-content">
                        • All HTTP traffic (unencrypted)<br>
                        • Login credentials<br>
                        • AirPlay metadata (song names, artists)<br>
                        • API calls and responses<br>
                        • Session cookies and tokens
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Slowloris Modal -->
    <div class="attack-modal" id="slowlorisModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">🌊 How Slowloris DoS Attack Works</h2>
                <button class="modal-close" onclick="closeModal('slowlorisModal')">✕</button>
            </div>
            <div class="modal-body">
                <div class="info-card">
                    <div class="info-card-title">What is Slowloris?</div>
                    <div class="info-card-content">
                        Slowloris is a denial-of-service attack that holds connections open by sending partial HTTP requests, 
                        never completing them. The server keeps waiting for the rest of the request, eventually running out 
                        of available connections for legitimate users.
                    </div>
                </div>

                <h3 style="color: #58a6ff; margin: 20px 0;">📨 Understanding HTTP Headers</h3>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                    <div>
                        <h4 style="color: #21ba45; margin-bottom: 10px;">✅ Normal HTTP Request</h4>
                        <div class="http-headers-viz">
                            <div class="http-header-line sent">GET / HTTP/1.1</div>
                            <div class="http-header-line sent">Host: 192.168.1.101</div>
                            <div class="http-header-line sent">User-Agent: Mozilla/5.0</div>
                            <div class="http-header-line sent">Accept-language: en-US</div>
                            <div class="http-header-line sent" style="background: rgba(33, 186, 69, 0.3);">
                                [Empty line - Request Complete! ✓]
                            </div>
                        </div>
                    </div>
                    <div>
                        <h4 style="color: #f85149; margin-bottom: 10px;">❌ Slowloris Request</h4>
                        <div class="http-headers-viz">
                            <div class="http-header-line sent">GET /?1234 HTTP/1.1</div>
                            <div class="http-header-line sent">Host: 192.168.1.101</div>
                            <div class="http-header-line sent">User-Agent: Mozilla/5.0</div>
                            <div class="http-header-line pending">X-Slowloris-1: keep-alive</div>
                            <div class="http-header-line missing">
                                [Never sends empty line! ✗]
                            </div>
                        </div>
                    </div>
                </div>

                <h3 style="color: #58a6ff; margin: 20px 0;">Server Connection Pool</h3>
                <div class="connection-pool" id="connectionPool">
                    <!-- Connection slots will be added dynamically -->
                </div>

                <div class="demo-controls">
                    <button class="demo-button" onclick="simulateSlowloris()">🌊 Start Slowloris</button>
                    <button class="demo-button secondary" onclick="resetSlowloris()">🔄 Reset</button>
                </div>

                <div class="attack-timeline">
                    <div class="timeline-line"></div>
                    
                    <div class="timeline-event">
                        <div class="timeline-dot"></div>
                        <div class="timeline-content">
                            <div class="timeline-time">0.000s</div>
                            <div class="timeline-title">Initial Connection</div>
                            <div class="timeline-desc">Send partial HTTP headers</div>
                        </div>
                    </div>
                    
                    <div class="timeline-event">
                        <div class="timeline-dot"></div>
                        <div class="timeline-content">
                            <div class="timeline-time">15.000s</div>
                            <div class="timeline-title">Keep-Alive Header</div>
                            <div class="timeline-desc">Send X-Slowloris-1: keep-alive</div>
                        </div>
                    </div>
                    
                    <div class="timeline-event">
                        <div class="timeline-dot"></div>
                        <div class="timeline-content">
                            <div class="timeline-time">30.000s</div>
                            <div class="timeline-title">Continue Forever</div>
                            <div class="timeline-desc">Keep connection open indefinitely</div>
                        </div>
                    </div>
                </div>

                <div class="info-card" style="margin-top: 20px;">
                    <div class="info-card-title">💡 Why It Works</div>
                    <div class="info-card-content">
                        • Servers have limited connection pools<br>
                        • Each connection waits for request completion<br>
                        • Slowloris never completes the request<br>
                        • Eventually, all connections are exhausted<br>
                        • Legitimate users can't connect
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let selectedAttack = null;
        let attackRunning = false;
        let terminalLines = [];

        // Initialize Matrix Rain
        function initMatrixRain() {
            const matrixRain = document.getElementById('matrixRain');
            const columns = Math.floor(window.innerWidth / 20);
            
            for (let i = 0; i < columns; i++) {
                const column = document.createElement('div');
                column.className = 'matrix-column';
                column.style.left = i * 20 + 'px';
                column.style.animationDuration = (Math.random() * 10 + 5) + 's';
                column.style.animationDelay = Math.random() * 5 + 's';
                
                // Generate random characters
                let chars = '';
                for (let j = 0; j < 30; j++) {
                    chars += Math.random() > 0.5 ? '1' : '0';
                    if (j < 29) chars += '<br>';
                }
                column.innerHTML = chars;
                
                matrixRain.appendChild(column);
            }
        }

        // Terminal functions
        function addTerminalLine(text, type = 'output') {
            const terminal = document.getElementById('mainTerminal');
            const line = document.createElement('div');
            line.className = 'terminal-line';
            
            let content = '';
            switch(type) {
                case 'command':
                    content = `<span class="terminal-prompt">root@kali:~#</span> <span class="terminal-command">${text}</span>`;
                    break;
                case 'success':
                    content = `<span class="terminal-success">${text}</span>`;
                    break;
                case 'error':
                    content = `<span class="terminal-error">${text}</span>`;
                    break;
                case 'warning':
                    content = `<span class="terminal-warning">${text}</span>`;
                    break;
                default:
                    content = `<span class="terminal-output">${text}</span>`;
            }
            
            line.innerHTML = content;
            terminal.appendChild(line);
            terminal.scrollTop = terminal.scrollHeight;
        }

        function clearTerminal() {
            const terminal = document.getElementById('mainTerminal');
            terminal.innerHTML = '<div class="terminal-line"><span class="terminal-prompt">root@kali:~#</span> <span class="terminal-command">clear</span></div>';
            addTerminalLine('Terminal cleared. Ready for new commands...', 'output');
        }

        // Attack selection
        function selectAttack(attack) {
            // Update selected attack
            selectedAttack = attack;
            
            // Update UI
            document.querySelectorAll('.attack-card').forEach(card => {
                card.classList.remove('active');
            });
            document.getElementById(attack + 'Card').classList.add('active');
            
            // Update attack status
            document.querySelectorAll('.attack-status').forEach(status => {
                status.classList.remove('active');
                status.classList.add('ready');
            });
            
            // Show attack details
            closeDetails();
            addTerminalLine(`Selected attack: ${attack.toUpperCase()}`, 'warning');
        }

        // Run selected attack
        function runSelectedAttack() {
            if (!selectedAttack) {
                addTerminalLine('Error: No attack selected!', 'error');
                return;
            }
            
            if (attackRunning) {
                addTerminalLine('Error: Attack already in progress!', 'error');
                return;
            }
            
            attackRunning = true;
            document.getElementById('runButton').disabled = true;
            document.getElementById('stopButton').disabled = false;
            
            // Update attack status
            const statusEl = document.querySelector(`#${selectedAttack}Card .attack-status`);
            statusEl.classList.remove('ready');
            statusEl.classList.add('active');
            
            switch(selectedAttack) {
                case 'hydra':
                    runHydraAttack();
                    break;
                case 'arp':
                    runArpAttack();
                    break;
                case 'slowloris':
                    runSlowlorisAttack();
                    break;
            }
        }

        // Hydra Attack Simulation
        function runHydraAttack() {
            addTerminalLine('hydra -l admin -P /usr/share/wordlists/rockyou.txt 192.168.1.101 http-post-form "/auth/login?next_url=/:username=admin&password=^PASS^:R=302"', 'command');
            
            setTimeout(() => {
                addTerminalLine('Hydra v9.1 (c) 2021 by van Hauser/THC & David Maciejak', 'output');
                addTerminalLine('[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries', 'output');
            }, 500);
            
            let attempts = 0;
            const passwords = ['123456', 'password', 'admin', 'letmein', 'welcome', 'abc123'];
            
            const attackInterval = setInterval(() => {
                if (!attackRunning) {
                    clearInterval(attackInterval);
                    return;
                }
                
                attempts += Math.floor(Math.random() * 100) + 50;
                addTerminalLine(`[ATTEMPT] Trying password ${attempts}/14344399...`, 'output');
                
                if (attempts > 300) {
                    clearInterval(attackInterval);
                    addTerminalLine('[80][http-post-form] host: 192.168.1.101   login: admin   password: abc123', 'success');
                    addTerminalLine('1 of 1 target successfully completed, 1 valid password found', 'success');
                    showSuccess();
                    document.getElementById('hydraDetails').classList.add('active');
                    completeAttack();
                }
            }, 1000);
        }

        // ARP Attack Simulation
        function runArpAttack() {
            addTerminalLine('ettercap -T -M arp:remote /192.168.1.101// /192.168.1.105//', 'command');
            
            setTimeout(() => {
                addTerminalLine('Ettercap 0.8.3.1 copyright 2001-2020', 'output');
                addTerminalLine('Listening on wlan0...', 'output');
            }, 500);
            
            setTimeout(() => {
                addTerminalLine('Starting Unified sniffing...', 'output');
                addTerminalLine('ARP poisoning victims:', 'warning');
                addTerminalLine(' GROUP 1 : 192.168.1.101 00:11:22:33:44:55', 'output');
                addTerminalLine(' GROUP 2 : 192.168.1.105 AA:BB:CC:DD:EE:FF', 'output');
            }, 1500);
            
            // Animate network connections
            animateNetworkAttack();
            
            setTimeout(() => {
                addTerminalLine('Captured HTTP POST to /api/streams/play', 'success');
                addTerminalLine('Captured AirPlay metadata: Artist - "The Beatles", Track - "Hey Jude"', 'success');
                document.getElementById('arpDetails').classList.add('active');
                showSuccess();
                completeAttack();
            }, 4000);
        }

        // Slowloris Attack Simulation
        function runSlowlorisAttack() {
            addTerminalLine('python3 slowloris.py -p 80 -s 10000 192.168.1.101', 'command');
            
            setTimeout(() => {
                addTerminalLine('[*] Attacking 192.168.1.101 on port 80 with 10000 sockets', 'warning');
                addTerminalLine('[*] Creating sockets...', 'output');
            }, 500);
            
            let sockets = 0;
            const attackInterval = setInterval(() => {
                if (!attackRunning) {
                    clearInterval(attackInterval);
                    return;
                }
                
                sockets += Math.floor(Math.random() * 500) + 300;
                if (sockets > 10000) sockets = 10000;
                
                addTerminalLine(`[+] Sending keep-alive headers... Socket count: ${sockets}`, 'output');
                
                if (sockets >= 10000) {
                    clearInterval(attackInterval);
                    addTerminalLine('[!] Target web server is no longer responding!', 'error');
                    addTerminalLine('[✓] DoS attack successful - Web interface down', 'success');
                    addTerminalLine('[i] Note: AirPlay streaming on port 7000 still functional', 'warning');
                    document.getElementById('slowlorisDetails').classList.add('active');
                    showSuccess();
                    completeAttack();
                }
            }, 800);
        }

        // Network animation
        function animateNetworkAttack() {
            const kali = document.getElementById('kaliDevice');
            const amplipro = document.getElementById('amplipiDevice');
            const iphone = document.getElementById('iphoneDevice');
            
            // Create connection lines
            createAttackLine(kali, amplipro);
            createAttackLine(kali, iphone);
            
            // Animate data packets
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    createDataPacket(iphone, amplipro, true);
                }, i * 1000);
            }
        }

        function createAttackLine(from, to) {
            const line = document.createElement('div');
            line.className = 'connection-line active';
            
            const fromRect = from.getBoundingClientRect();
            const toRect = to.getBoundingClientRect();
            const containerRect = from.parentElement.getBoundingClientRect();
            
            const x1 = fromRect.left + fromRect.width / 2 - containerRect.left;
            const y1 = fromRect.top + fromRect.height / 2 - containerRect.top;
            const x2 = toRect.left + toRect.width / 2 - containerRect.left;
            const y2 = toRect.top + toRect.height / 2 - containerRect.top;
            
            const length = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
            const angle = Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI;
            
            line.style.width = length + 'px';
            line.style.left = x1 + 'px';
            line.style.top = y1 + 'px';
            line.style.transform = `rotate(${angle}deg)`;
            
            document.getElementById('networkViz').appendChild(line);
        }

        function createDataPacket(from, to, isAttack = false) {
            const packet = document.createElement('div');
            packet.className = 'data-packet' + (isAttack ? ' attack' : '');
            
            const fromRect = from.getBoundingClientRect();
            const toRect = to.getBoundingClientRect();
            const containerRect = from.parentElement.getBoundingClientRect();
            
            packet.style.left = (fromRect.left + fromRect.width / 2 - containerRect.left - 10) + 'px';
            packet.style.top = (fromRect.top + fromRect.height / 2 - containerRect.top - 10) + 'px';
            
            document.getElementById('networkViz').appendChild(packet);
            
            setTimeout(() => {
                packet.style.transition = 'all 1s ease-in-out';
                packet.style.left = (toRect.left + toRect.width / 2 - containerRect.left - 10) + 'px';
                packet.style.top = (toRect.top + toRect.height / 2 - containerRect.top - 10) + 'px';
            }, 50);
            
            setTimeout(() => packet.remove(), 1100);
        }

        // Stop attack
        function stopAttack() {
            attackRunning = false;
            document.getElementById('runButton').disabled = false;
            document.getElementById('stopButton').disabled = true;
            
            // Update attack status
            document.querySelectorAll('.attack-status').forEach(status => {
                status.classList.remove('active');
                status.classList.add('ready');
            });
            
            addTerminalLine('^C', 'command');
            addTerminalLine('Attack terminated by user.', 'error');
            
            // Clear any network animations
            document.querySelectorAll('.connection-line, .data-packet').forEach(el => el.remove());
        }

        // Complete attack
        function completeAttack() {
            attackRunning = false;
            document.getElementById('runButton').disabled = false;
            document.getElementById('stopButton').disabled = true;
            
            // Update status
            const statusEl = document.querySelector(`#${selectedAttack}Card .attack-status`);
            statusEl.classList.remove('active');
            statusEl.classList.add('ready');
        }

        // Close details
        function closeDetails() {
            document.querySelectorAll('.attack-details').forEach(details => {
                details.classList.remove('active');
            });
        }

        // Show network scan
        function showNetworkScan() {
            addTerminalLine('nmap -sn 192.168.1.0/24', 'command');
            
            setTimeout(() => {
                addTerminalLine('Starting Nmap 7.91 scan...', 'output');
                addTerminalLine('Nmap scan report for 192.168.1.1', 'output');
                addTerminalLine('Host is up (0.0012s latency).', 'success');
                addTerminalLine('MAC Address: 00:11:22:33:44:55 (Router)', 'output');
                addTerminalLine('', 'output');
                addTerminalLine('Nmap scan report for 192.168.1.101', 'output');
                addTerminalLine('Host is up (0.0023s latency).', 'success');
                addTerminalLine('MAC Address: AA:BB:CC:DD:EE:FF (AmpliPi)', 'output');
                addTerminalLine('Open ports: 80/tcp (http), 5001/tcp (service), 7000/tcp (afs3-fileserver)', 'warning');
                addTerminalLine('', 'output');
                addTerminalLine('Nmap scan report for 192.168.1.105', 'output');
                addTerminalLine('Host is up (0.0034s latency).', 'success');
                addTerminalLine('MAC Address: 11:22:33:44:55:66 (Apple iPhone)', 'output');
                addTerminalLine('', 'output');
                addTerminalLine('Nmap done: 256 IP addresses (3 hosts up) scanned in 2.43 seconds', 'output');
            }, 1000);
        }

        // Status indicators
        function showSuccess() {
            const indicator = document.getElementById('statusIndicator');
            indicator.className = 'status-indicator success';
            indicator.textContent = '✓';
            setTimeout(() => {
                indicator.className = 'status-indicator';
            }, 1000);
        }

        function showFail() {
            const indicator = document.getElementById('statusIndicator');
            indicator.className = 'status-indicator fail';
            indicator.textContent = '✗';
            setTimeout(() => {
                indicator.className = 'status-indicator';
            }, 1000);
        }

        // NEW: Attack explanation functions
        function showAttackExplanation(attack) {
            document.getElementById(attack + 'Modal').classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // NEW: Password attack visualization
        function simulatePasswordAttack() {
            const passwords = [
                '123456', 'password', 'admin', 'qwerty', 'letmein',
                'welcome', 'monkey', 'dragon', '1234567', 'baseball',
                'iloveyou', 'trustno1', 'sunshine', 'master', 'abc123'
            ];
            
            const viz = document.getElementById('passwordViz');
            viz.innerHTML = '';
            
            let attempts = 0;
            let startTime = Date.now();
            
            passwords.forEach((pass, index) => {
                const div = document.createElement('div');
                div.className = 'password-attempt';
                div.textContent = pass;
                viz.appendChild(div);
                
                setTimeout(() => {
                    div.classList.add('trying');
                    attempts++;
                    document.getElementById('passAttempts').textContent = attempts;
                    
                    const elapsed = (Date.now() - startTime) / 1000;
                    document.getElementById('passSpeed').textContent = Math.floor(attempts / elapsed);
                    document.getElementById('passTime').textContent = elapsed.toFixed(1) + 's';
                    
                    setTimeout(() => {
                        if (pass === 'abc123') {
                            div.classList.remove('trying');
                            div.classList.add('success');
                            div.textContent += ' ✓';
                        } else {
                            div.classList.remove('trying');
                            div.classList.add('failed');
                        }
                    }, 500);
                }, index * 600);
            });
        }

        function resetPasswordViz() {
            document.getElementById('passwordViz').innerHTML = '';
            document.getElementById('passAttempts').textContent = '0';
            document.getElementById('passSpeed').textContent = '0';
            document.getElementById('passTime').textContent = '0s';
        }

        // NEW: ARP poisoning visualization
        function simulateArpPoison() {
            const entry1 = document.getElementById('arpEntry1');
            const entry2 = document.getElementById('arpEntry2');
            const mac1 = document.getElementById('arpMac1');
            const mac2 = document.getElementById('arpMac2');
            
            setTimeout(() => {
                entry1.classList.add('poisoned');
                mac1.textContent = '00:11:22:33:44:55 (Kali!)';
                mac1.style.color = '#f85149';
            }, 500);
            
            setTimeout(() => {
                entry2.classList.add('poisoned');
                mac2.textContent = '00:11:22:33:44:55 (Kali!)';
                mac2.style.color = '#f85149';
            }, 1000);
        }

        function resetArpTable() {
            document.getElementById('arpEntry1').classList.remove('poisoned');
            document.getElementById('arpEntry2').classList.remove('poisoned');
            document.getElementById('arpMac1').textContent = 'AA:BB:CC:DD:EE:FF';
            document.getElementById('arpMac1').style.color = '';
            document.getElementById('arpMac2').textContent = '11:22:33:44:55:66';
            document.getElementById('arpMac2').style.color = '';
        }

        // NEW: Slowloris visualization
        function simulateSlowloris() {
            const pool = document.getElementById('connectionPool');
            pool.innerHTML = '';
            
            // Create 100 connection slots
            for (let i = 0; i < 100; i++) {
                const slot = document.createElement('div');
                slot.className = 'connection-slot available';
                slot.textContent = i + 1;
                pool.appendChild(slot);
            }
            
            // Gradually fill connections
            let occupied = 0;
            const fillInterval = setInterval(() => {
                if (occupied >= 100) {
                    clearInterval(fillInterval);
                    return;
                }
                
                const available = pool.querySelectorAll('.available');
                if (available.length > 0) {
                    const randomSlot = available[Math.floor(Math.random() * available.length)];
                    randomSlot.classList.remove('available');
                    randomSlot.classList.add('occupied');
                    randomSlot.textContent = '🔒';
                    occupied++;
                }
            }, 50);
        }

        function resetSlowloris() {
            const pool = document.getElementById('connectionPool');
            pool.innerHTML = '';
        }

        // Highlight flow steps
        function highlightFlowSteps(stepPrefix, count) {
            for (let i = 1; i <= count; i++) {
                setTimeout(() => {
                    document.getElementById(stepPrefix + i).classList.add('active');
                }, i * 1000);
            }
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === '1') selectAttack('hydra');
            if (e.key === '2') selectAttack('arp');
            if (e.key === '3') selectAttack('slowloris');
            if (e.key === 'Enter' && !attackRunning) runSelectedAttack();
            if (e.key === 'Escape') {
                if (attackRunning) {
                    stopAttack();
                } else {
                    document.querySelectorAll('.attack-modal').forEach(modal => {
                        modal.classList.remove('active');
                    });
                }
            }
            if (e.key === 'c' && e.ctrlKey) stopAttack();
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initMatrixRain();
            addTerminalLine('Kali Linux 2023.4 - The quieter you become, the more you are able to hear', 'output');
            addTerminalLine('', 'output');
            addTerminalLine('Target identified: AmpliPro Home Audio System at 192.168.1.101', 'warning');
            addTerminalLine('Select an attack from the dashboard above to begin testing...', 'output');
        });
    </script>
</body>
</html>